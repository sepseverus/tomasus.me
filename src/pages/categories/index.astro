---
import { getCollection } from "astro:content";
import Main from "@/layouts/Main.astro";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { SITE } from "@/config";
import getPostsByCategory from "@/utils/getPostsByCategory";

const posts = await getCollection("blog");

const categories = [
  {
    name: "Tech",
    slug: "tech",
    description: "Technology, AI, and cybersecurity",
    count: getPostsByCategory(posts, "Tech").length,
  },
  {
    name: "Brain",
    slug: "brain",
    description: "Health, mental wellness, and personal development",
    count: getPostsByCategory(posts, "Brain").length,
  },
  {
    name: "History",
    slug: "history",
    description: "Historical perspectives and lessons",
    count: getPostsByCategory(posts, "History").length,
  },
];
---

<Layout title={`Categories | ${SITE.title}`}>
  <Header />
  <Main pageTitle="Categories" pageDesc="Browse posts by category.">
    <ul class="grid gap-6 sm:grid-cols-3">
      {
        categories.map(category => (
          <li>
            <a
              href={`/categories/${category.slug}`}
              class="group block rounded-lg border border-border bg-muted/30 p-6 transition-all hover:border-accent hover:bg-muted/50"
            >
              <h2 class="mb-2 text-xl font-semibold text-foreground group-hover:text-accent">
                {category.name}
              </h2>
              <p class="mb-3 text-sm text-foreground/70">
                {category.description}
              </p>
              <p class="text-sm font-medium text-accent">
                {category.count} {category.count === 1 ? "post" : "posts"}
              </p>
            </a>
          </li>
        ))
      }
    </ul>
  </Main>
  <Footer />
</Layout>
